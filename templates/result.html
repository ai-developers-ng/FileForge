{% extends 'base.html' %}

{% block title %}Result - {{ job.filename }} | FileForge{% endblock %}
{% block meta_description %}View your conversion result for {{ job.filename }}. Download your processed file in TXT, JSON, or PDF format.{% endblock %}

{% block content %}
<div class="page">
    <header class="hero-header">
        <h1>{{ job.filename }}</h1>
        <p>Job status: <strong>{{ job.status }}</strong></p>
    </header>

    <div class="converter-card">
        <div class="results-header">
            <div>
                <h2>Result Details</h2>
                <p>Job ID: {{ job.id }}</p>
            </div>
            <span class="status-pill">
                <span class="status-dot"></span>
                {{ job.status }}
            </span>
        </div>

        <div class="result-preview" style="margin-top: 24px;">
            <div class="result-meta">
                <span>{{ job.filename }}</span>
                {% if job.error %}
                <span class="meta-chip" style="background: rgba(239, 68, 68, 0.1); color: #dc2626;">Error</span>
                {% elif job.status == "completed" %}
                <span class="meta-chip" style="background: rgba(34, 197, 94, 0.1); color: #16a34a;">Completed</span>
                {% elif job.status == "processing" %}
                <span class="meta-chip" style="background: rgba(99, 102, 241, 0.1); color: #6366f1;">Processing</span>
                {% else %}
                <span class="meta-chip">{{ job.status }}</span>
                {% endif %}
            </div>

            {% if job.error %}
            <div class="alert alert-error" style="margin-top: 16px;">
                {{ job.error }}
            </div>
            {% else %}
            <textarea class="result-textarea" readonly>Open the download links below to view full output.</textarea>
            {% endif %}
        </div>

        <div class="result-actions">
            <a class="ghost btn" href="{{ url_for('index') }}">Back to Home</a>
            {% if job.status == "completed" %}
            <a class="primary btn" href="/api/jobs/{{ job.id }}/download/txt?token={{ token }}">Download TXT</a>
            <a class="ghost btn" href="/api/jobs/{{ job.id }}/download/json?token={{ token }}">Download JSON</a>
            <a class="ghost btn" href="/api/jobs/{{ job.id }}/download/pdf?token={{ token }}">Download PDF</a>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
